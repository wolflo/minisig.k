requires "edsl.md"
requires "lemmas.k"
requires "dirty-lemmas.k"

module VERIFICATION
  imports EVM
  imports EDSL
  imports LEMMAS
  imports DIRTY-LEMMAS

  syntax Int ::= "#exec_typehash"
  rule #exec_typehash => #parseHexWord("0x9c1370cbf5462da152553d1b9556f96a7eb4dfe28fbe07e763227834d409103a") [macro]

  syntax ByteArray ::= "#runtime"
// returns digest, keccak(0x1901 ++ dom_sep ++ struct_hash)
  rule #runtime => #parseByteStack("6000803560e01c8063abd2b4c014156102555750602060a4356004018035809160200183378120817f9c1370cbf5462da152553d1b9556f96a7eb4dfe28fbe07e763227834d409103a81526020016004358152602001602435815260200160443581526020016000548152602001606435815260200160843581526020015280610100902090611901815280601e01906020806102880182602001398281604001526042822060005260206000f361012036106102815760006102888038039139600435801590331417156102815760c435600401356000516041021161028157600054806001016000555960a4356004018035809160200183378120817f9c1370cbf5462da152553d1b9556f96a7eb4dfe28fbe07e763227834d409103a8152602001600435815260200160243581526020016044358152602001838152602001606435815260200160843581526020015280610100902090611901815280601e019060200160205181526020018290526042902060c435602401600051596000805b838110156101f3578060410283602001878152604087830182604001378682602101013560ff16816020015260208560808360015afa1561028157845184905b816040511115610281578160200260600151146101e2576001016101c3565b600101905090509150600101610183565b6044356102205760008060a435600401803580916020016000376000608435602435606435f11561028157005b60443560011415610281576084353414156102815760a435600401803580916020016000376000602435606435f41561028157005b36156102865734153660041416156102815763affed0e01461027657610281565b600080548152602090f35b600080fd5b00") [macro]
endmodule
