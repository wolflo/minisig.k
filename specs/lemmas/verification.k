requires "edsl.md"
requires "lemmas.k"
requires "dirty-lemmas.k"

module VERIFICATION
  imports EVM
  imports EDSL
  imports LEMMAS
  imports DIRTY-LEMMAS

  syntax Int ::= "#exec_typehash"
  rule #exec_typehash => #parseHexWord("0x9c1370cbf5462da152553d1b9556f96a7eb4dfe28fbe07e763227834d409103a") [macro]

  syntax ByteArray ::= "#runtime"
// returns struct hash
// -- keccak(EXEC_THASH, _source, _target, _ctype, nonce, _callGas, _value, keccak(_data))
  rule #runtime => #parseByteStack("6000803560e01c8063abd2b4c014156102345750602060a4356004018035809160200183378120817f9c1370cbf5462da152553d1b9556f96a7eb4dfe28fbe07e763227834d409103a81526020016004358152602001602435815260200160443581526020016000548152602001606435815260200160843581526020015280610100902060005260206000f361012036106102605760006102678038039139600435801590331417156102605760c435600401356000516041021161026057600054806001016000555960a4356004018035809160200183378120817f9c1370cbf5462da152553d1b9556f96a7eb4dfe28fbe07e763227834d409103a8152602001600435815260200160243581526020016044358152602001838152602001606435815260200160843581526020015280610100902090611901815280601e019060200160205181526020018290526042902060c435602401600051596000805b838110156101d2578060410283602001878152604087830182604001378682602101013560ff16816020015260208560808360015afa1561026057845184905b816040511115610260578160200260600151146101c1576001016101a2565b600101905090509150600101610162565b6044356101ff5760008060a435600401803580916020016000376000608435602435606435f11561026057005b60443560011415610260576084353414156102605760a435600401803580916020016000376000602435606435f41561026057005b36156102655734153660041416156102605763affed0e01461025557610260565b600080548152602090f35b600080fd5b00") [macro]
endmodule
